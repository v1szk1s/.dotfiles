#!/bin/sh

# Get volume and mute state from wpctl
volume_line=$(wpctl get-volume @DEFAULT_AUDIO_SINK@)

# Extract volume (float) and mute flag (if present)
volume=$(echo "$volume_line" | awk '{print $2}')
muted=$(echo "$volume_line" | grep -q MUTED && echo "true" || echo "false")

# Convert volume to integer percentage
volume_percent=$(printf "%.0f\n" "$(echo "$volume * 100" | bc -l)")


volume_percent=$(printf "%.0f\n" "$(echo "$(echo "$volume_line" | awk '{print $2}') * 100" | bc -l)")

# Pick icon
if [ "$muted" = "true" ]; then
    icon="󰖁"
    echo "$icon mute"
else
    if [ "$volume_percent" -lt 30 ]; then
        icon="󰕿"
    elif [ "$volume_percent" -lt 70 ]; then
        icon="󰖀"
    else
        icon="󰕾"
    fi
    echo "$icon $volume_percent%"
fi


# #!/bin/sh
#
# # Get volume and mute state
# volume=$(pamixer --get-volume)
# muted=$(pamixer --get-mute)
#
# # Pick icon
# if [ "$muted" = "true" ]; then
#     icon="󰖁"
#     echo "$icon mute"
# else
#     if [ "$volume" -lt 30 ]; then
#         icon="󰕿"
#     elif [ "$volume" -lt 70 ]; then
#         icon="󰖀"
#     else
#         icon="󰕾"
#     fi
#     echo "$icon $volume%"
# fi
#
